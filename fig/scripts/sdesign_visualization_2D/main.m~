clear
close all 
clc

nodes=load('./geometry/designelementnodes');
nodesfine=load('./geometry/nodesfine');
nacanodes=load('./geometry/nacanodes');

numnode=size(nodes,1)
numnacanodes=size(nacanodes,1)


for i=1:numnode
    node=nodes(i,:)
    x=node(1)
    y=node(2)
    
    A(i,:)=genlocvec(node);
end

for i=1:numnode
    rhs=zeros(numnode,1)
    rhs(i)=1
    sevalmat(i,:)=[A\rhs]'
end



 
plotall(figure(),nodes,'ko--',...
                  nodesfine,'b--',...
                  nacanodes,'r--');
              
cases={'case1',
 
disp=[...
    0.00  0.05
    0.00  0.00
    0.00  0.00
    0.00 -0.05
    0.00 -0.05
    0.00  0.00
    0.00  0.00
    0.00  0.05]

nacanodesmoved=movenodes(nacanodes,sevalmat,disp);
nodesfinemoved=movenodes(nodesfine,sevalmat,disp);

%% Plot the deformed configuration
plotall(gcf,nodes,'ko',...
            nodesfinemoved,'b-',...
            nacanodesmoved,'r-')
set(gca,'LineWidth',5)